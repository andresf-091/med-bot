# Миграции базы данных

Проект использует Alembic для версионирования схемы базы данных.

## Установка

Установите зависимости:
```bash
uv sync
# или
pip install -e .
```

## Применение миграций

### При первом запуске или после обновления кода:
```bash
python database/init_db.py
```

### Или используйте скрипт:
```bash
python scripts/migrate.py
```

### Или напрямую через Alembic:
```bash
alembic upgrade head
```

## Создание новой миграции

После изменения моделей в `database/models/`:

1. Создайте автоматическую миграцию:
```bash
alembic revision --autogenerate -m "описание изменений"
```

2. Проверьте созданный файл миграции в `alembic/versions/`

3. Примените миграцию:
```bash
alembic upgrade head
```

## Откат миграций

Откатить на одну версию назад:
```bash
alembic downgrade -1
```

Откатить все миграции:
```bash
alembic downgrade base
```

## Проверка текущей версии

```bash
alembic current
```

## История миграций

```bash
alembic history
```

## Важно

- **Не редактируйте существующие миграции** после их применения в production
- Всегда проверяйте автогенерированные миграции перед применением
- Делайте бэкап базы данных перед применением миграций в production
